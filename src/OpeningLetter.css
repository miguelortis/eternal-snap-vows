/* src/OpeningLetter.css */

/* --- Keyframes (Animaciones) --- */

@keyframes fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes fade-out-seal {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}

@keyframes open-flap {
  from {
    transform: rotateX(0deg);
  }
  to {
    z-index: 0; /* Asegura que la solapa quede detrás de la carta */
    transform: rotateX(-180deg); /* Gira hacia arriba y atrás */
  }
}

@keyframes slide-card {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(
      -85%
    ); /* Saca la carta (no al 100% para que se vea un poco) */
  }
}

/* --- Estilos Generales --- */

.letter-overlay {
  position: fixed;
  inset: 0;
  background-color: hsla(var(--cream) / 0.8);
  backdrop-filter: blur(8px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 1;
  pointer-events: none;
}

.letter-overlay.fade-out {
  animation: fade-out 0.5s ease-out 0.5s forwards; /* Espera 0.5s antes de desaparecer */
}

.envelope-wrapper {
  position: relative;
  width: 380px;
  height: 250px;
  perspective: 1000px;
  /* El fondo del wrapper (lo que se ve *detrás* de la carta) */
  background-color: hsl(var(--olive-light));
  border-radius: 8px;
  box-shadow: 0 8px 30px hsla(var(--olive-light) / 0.3);
  /* overflow: hidden; <-- Quitado para que la carta pueda "salirse" */
}

/* --- 1. LA CARTA (INVITACIÓN) --- */
.envelope-card {
  position: absolute;
  top: 6px; /* <-- CAMBIO: Empieza desde arriba */
  left: 5%;
  width: 90%;
  height: 95%; /* Un poco más pequeña que el sobre */
  background-color: hsl(var(--cream));
  border-radius: 6px;
  border: 2px solid hsl(var(--gold));
  box-shadow: 0 0 0 2px hsl(var(--cream)), 0 0 0 4px hsl(var(--gold));

  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 30px 20px;

  z-index: 1; /* <-- Detrás de todas las solapas */

  transform: translateY(0); /* Estado inicial */
}

/* Estilos para el logo/monograma simulado */
.monogram-logo {
  position: relative;
  width: 60px; /* Más pequeño */
  height: 60px;
  border-radius: 50%;
  border: 1px solid hsl(var(--gold));
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: transparent;
  margin-bottom: 10px; /* Reducido */
}
/* ... (puedes añadir los pseudo-elementos ::before y ::after si quieres el detalle de las hojas) ... */

/* --- 2. LAS 4 SOLAPAS DEL SOBRE --- */
/* Base común para las solapas */
.envelope-wrapper > [class*="envelope-flap-"] {
  position: absolute;
  width: 100%;
  height: 100%;
  /* Color de la parte "trasera" del sobre, como en la imagen */
  background-color: hsl(var(--olive-light));
}

.envelope-flap-bottom {
  clip-path: polygon(0 100%, 100% 100%, 50% 50%); /* Triángulo inferior */
  z-index: 2;
}
.envelope-flap-left {
  clip-path: polygon(0 0, 0 100%, 50% 50%); /* Triángulo izquierdo */
  z-index: 3;
}
.envelope-flap-right {
  clip-path: polygon(100% 0, 100% 100%, 50% 50%); /* Triángulo derecho */
  z-index: 4;
}
.envelope-flap-top {
  clip-path: polygon(0 0, 100% 0, 50% 50%); /* Triángulo superior */
  z-index: 5;
  transform-origin: top; /* Gira desde el borde superior */
  animation-fill-mode: forwards;
}

/* --- 3. DECORACIÓN (CUERDA Y SELLO) --- */
.envelope-decoration {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 6; /* Encima de todas las solapas */
  pointer-events: none;
  opacity: 1;
}

.envelope-string {
  position: absolute;
  top: 50%;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: #e1dfda; /* Un color de cuerda/yute */
  transform: translateY(-50%);
}
.envelope-string::before {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: 2px;
  height: 250px; /* Cuerda vertical */
  background-color: #e1dfda;
  transform: translate(-50%, -50%);
}

.envelope-seal {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 50px;
  height: 50px;
  /* Color rojo/vino para el sello de cera */
  background-color: #8c2a3c;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
  border: 2px solid #6e202e; /* Borde más oscuro */
}
.envelope-seal::before {
  content: "AD";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-5deg);
  color: hsla(var(--gold) / 0.8);
  font-family: "Times New Roman", serif;
  font-size: 1.5rem;
  font-weight: bold;
  text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
}

/* --- SECUENCIA DE ANIMACIÓN --- */

/* 1. Ocultar la decoración (sello y cuerda) */
.letter-overlay.animating .envelope-decoration {
  animation: fade-out-seal 0.5s ease-out forwards;
}

/* 2. Abrir la solapa (después de 0.3s) */
.letter-overlay.animating .envelope-flap-top {
  animation: open-flap 0.7s 0.3s ease-in-out forwards;
}

/* 3. Sacar la carta (después de 0.8s) */
.letter-overlay.animating .envelope-card {
  animation: slide-card 1.2s 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards;
}

@media (max-width: 400px) {
  .envelope-wrapper {
    width: 310px;
    height: 190px;
  }
  .envelope-string::before {
    height: 190px; /* Ajusta la altura de la cuerda vertical */
  }
}
